<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Journal - System Analytics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #0f172a;
            color: #e2e8f0;
            line-height: 1.6;
            padding: 10px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(to right, #1e293b, #0f172a);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5rem;
            color: #3b82f6;
        }

        .logo h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
            background-color: #1e293b;
            padding: 5px;
            border-radius: 10px;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            color: #94a3b8;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            text-decoration: none;
        }

        .tab-btn:hover {
            color: #cbd5e1;
            background-color: #334155;
        }

        .tab-btn.active {
            color: #ffffff;
            background-color: #3b82f6;
        }

        .page-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #f8fafc;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background-color: #1e293b;
            border-radius: 10px;
        }

        .page-title i {
            color: #3b82f6;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
            padding: 15px;
            background-color: #1e293b;
            border-radius: 10px;
        }

        .table-selection {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 150px;
        }

        .filter-group label {
            font-size: 0.9rem;
            color: #94a3b8;
            font-weight: 500;
        }

        select, input {
            padding: 10px 12px;
            background-color: #334155;
            border: 1px solid #475569;
            border-radius: 6px;
            color: #f8fafc;
            font-size: 0.9rem;
            cursor: pointer;
        }

        select:hover, select:focus {
            border-color: #3b82f6;
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: #10b981;
        }

        .btn-primary:hover {
            background-color: #059669;
        }

        .btn-secondary {
            background-color: #3b82f6;
        }

        .btn-secondary:hover {
            background-color: #2563eb;
        }

        .btn-danger {
            background-color: #ef4444;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .systems-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .system-card {
            background-color: #1e293b;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #334155;
            transition: transform 0.3s, box-shadow 0.3s;
            display: none;
        }

        .system-card.active {
            display: block;
        }

        .system-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .system-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #f8fafc;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #334155;
        }

        .system-card table {
            width: 100%;
            border-collapse: collapse;
        }

        .system-card th {
            padding: 12px 8px;
            font-size: 0.9rem;
            background-color: #0f172a;
            text-align: left;
            border-bottom: 2px solid #334155;
            white-space: nowrap;
        }

        .system-card td {
            padding: 10px 8px;
            font-size: 0.9rem;
            white-space: normal;
            border-bottom: 1px solid #334155;
        }

        .win-rate {
            font-weight: 600;
            color: #3b82f6;
        }

        .outcomes-cell {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .outcome-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .outcome-profit {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .outcome-loss {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .outcome-break-even {
            background-color: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background-color: #1e293b;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border-left: 4px solid #3b82f6;
        }

        .stat-card h4 {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 5px;
        }

        .stat-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #f8fafc;
        }

        .stat-card .sub-value {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-top: 1px solid #334155;
            color: #94a3b8;
            font-size: 0.9rem;
            background-color: #1e293b;
            border-radius: 10px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .systems-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .table-selection {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-controls {
                flex-direction: column;
                width: 100%;
            }
            
            .filter-group {
                width: 100%;
            }
            
            .table-container {
                overflow-x: auto;
            }
        }

        .system-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-color: #3b82f6;
            color: white;
            border-radius: 50%;
            font-size: 0.8rem;
            margin-right: 8px;
        }

        .table-container {
            overflow-x: auto;
        }

        .column-filter {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-top: 5px;
        }

        .column-filter select {
            padding: 6px 8px;
            font-size: 0.8rem;
            background-color: #1e293b;
            border: 1px solid #475569;
        }

        .no-data {
            text-align: center;
            padding: 30px;
            color: #94a3b8;
        }

        .no-data i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #475569;
        }

        .show-all-btn {
            margin-top: 15px;
            display: inline-block;
            padding: 8px 16px;
            background-color: #334155;
            color: #cbd5e1;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .show-all-btn:hover {
            background-color: #475569;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <h1>Trading Journal</h1>
            </div>
            
            <div class="nav-tabs">
                <a href="index.html" class="tab-btn">
                    <i class="fas fa-table"></i>
                    Journal Table
                </a>
                <a href="#" class="tab-btn active">
                    <i class="fas fa-chart-bar"></i>
                    System Analytics
                </a>
              <a href="master-list.html" class="tab-btn">    
                <i class="fas fa-chart-bar"></i>    
                Master List 
            </a>    
            </div>
        </header>

        <!-- System Analytics Page -->
        <div>
            <h2 class="page-title">
                <i class="fas fa-chart-bar"></i>
                System Analytics - Performance Metrics
            </h2>
            
            <div class="controls">
                <div class="table-selection">
                    <div class="filter-group">
                        <label for="table-select">Select Table (1-18)</label>
                        <select id="table-select">
                            <option value="1">1. Accounts Performance</option>
                            <option value="2">2. Symbols Performance</option>
                            <option value="3">3. Trading Models</option>
                            <option value="4">4. News Impact Analysis</option>
                            <option value="5">5. Narrative Analysis</option>
                            <option value="6">6. Bias Analysis</option>
                            <option value="7">7. Market Conditions</option>
                            <option value="8">8. Type of Trade Analysis</option>
                            <option value="9">9. Session Analysis</option>
                            <option value="10">10. Entry Time Frame Analysis</option>
                            <option value="11">11. Confluences Analysis</option>
                            <option value="12">12. Entry Signals Analysis</option>
                            <option value="13">13. Order Type Analysis</option>
                            <option value="14">14. Performance By Day</option>
                            <option value="15">15. SL Management Analysis</option>
                            <option value="16">16. TP Management Analysis</option>
                            <option value="17">17. Mistakes Analysis</option>
                            <option value="18">18. Psychology Analysis</option>
                        </select>
                    </div>
                    
                    <div class="filter-controls" id="global-filters" style="display: none;">
                        <div class="filter-group">
                            <label for="global-model-filter">Filter by Model</label>
                            <select id="global-model-filter">
                                <option value="">All Models</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label for="global-symbol-filter">Filter by Symbol</label>
                            <select id="global-symbol-filter">
                                <option value="">All Symbols</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-secondary btn-small" id="apply-global-filters">
                            <i class="fas fa-filter"></i>
                            Apply Filters
                        </button>
                        
                        <button class="btn btn-danger btn-small" id="clear-global-filters">
                            <i class="fas fa-times"></i>
                            Clear Filters
                        </button>
                    </div>
                </div>
                
                <div>
                    <button class="btn btn-secondary" id="refresh-analytics">
                        <i class="fas fa-sync-alt"></i>
                        Refresh Analytics
                    </button>
                </div>
            </div>
            
            <div class="stats-summary">
                <div class="stat-card">
                    <h4>Total Trades</h4>
                    <div class="value" id="total-trades">0</div>
                    <div class="sub-value">All Systems</div>
                </div>
                <div class="stat-card">
                    <h4>Overall Win Rate</h4>
                    <div class="value" id="overall-win-rate">0%</div>
                    <div class="sub-value">Across All Trades</div>
                </div>
                <div class="stat-card">
                    <h4>Best Performing Model</h4>
                    <div class="value" id="best-model">-</div>
                    <div class="sub-value" id="best-model-rate">0% Win Rate</div>
                </div>
                <div class="stat-card">
                    <h4>Most Traded Symbol</h4>
                    <div class="value" id="top-symbol">-</div>
                    <div class="sub-value" id="top-symbol-count">0 trades</div>
                </div>
            </div>
            
            <div class="systems-container" id="systems-container">
                <!-- All 18 system tables will be dynamically added here -->
                <div class="system-card active" id="table-1">
                    <h3><span class="system-number">1</span><i class="fas fa-wallet"></i> Accounts Performance</h3>
                    <div class="table-container">
                        <table id="accounts-table">
                            <thead>
                                <tr>
                                    <th>Account</th>
                                    <th>Win Rate</th>
                                    <th>No. of Trades</th>
                                </tr>
                            </thead>
                            <tbody id="accounts-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-2">
                    <h3><span class="system-number">2</span><i class="fas fa-chart-line"></i> Symbols Performance</h3>
                    <div class="table-container">
                        <table id="symbols-table">
                            <thead>
                                <tr>
                                    <th>Pair</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="symbols-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-3">
                    <h3><span class="system-number">3</span><i class="fas fa-cogs"></i> Trading Models</h3>
                    <div class="table-container">
                        <table id="models-table">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="models-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-4">
                    <h3><span class="system-number">4</span><i class="fas fa-newspaper"></i> News Impact Analysis</h3>
                    <div class="table-container">
                        <table id="news-table">
                            <thead>
                                <tr>
                                    <th>News Impact</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                </tr>
                            </thead>
                            <tbody id="news-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-5">
                    <h3><span class="system-number">5</span><i class="fas fa-comment"></i> Narrative Analysis</h3>
                    <div class="table-container">
                        <table id="narrative-table">
                            <thead>
                                <tr>
                                    <th>Narrative</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="narrative-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-6">
                    <h3><span class="system-number">6</span><i class="fas fa-balance-scale"></i> Bias Analysis</h3>
                    <div class="table-container">
                        <table id="bias-table">
                            <thead>
                                <tr>
                                    <th>Bias</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="bias-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-7">
                    <h3><span class="system-number">7</span><i class="fas fa-chart-area"></i> Market Conditions</h3>
                    <div class="table-container">
                        <table id="market-table">
                            <thead>
                                <tr>
                                    <th>Market Condition</th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="market-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-8">
                    <h3><span class="system-number">8</span><i class="fas fa-exchange-alt"></i> Type of Trade Analysis</h3>
                    <div class="table-container">
                        <table id="tradetype-table">
                            <thead>
                                <tr>
                                    <th>Trade Type</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table8-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table8-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="tradetype-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-9">
                    <h3><span class="system-number">9</span><i class="fas fa-clock"></i> Session Analysis</h3>
                    <div class="table-container">
                        <table id="session-table">
                            <thead>
                                <tr>
                                    <th>Session</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table9-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table9-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="session-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-10">
                    <h3><span class="system-number">10</span><i class="fas fa-chart-bar"></i> Entry Time Frame Analysis</h3>
                    <div class="table-container">
                        <table id="timeframe-table">
                            <thead>
                                <tr>
                                    <th>Time Frame</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table10-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table10-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="timeframe-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-11">
                    <h3><span class="system-number">11</span><i class="fas fa-layer-group"></i> Confluences Analysis</h3>
                    <div class="table-container">
                        <table id="confluences-table">
                            <thead>
                                <tr>
                                    <th>Confluences</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table11-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table11-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="confluences-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-12">
                    <h3><span class="system-number">12</span><i class="fas fa-bell"></i> Entry Signals Analysis</h3>
                    <div class="table-container">
                        <table id="entrysignals-table">
                            <thead>
                                <tr>
                                    <th>Entry Signals</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table12-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table12-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="entrysignals-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-13">
                    <h3><span class="system-number">13</span><i class="fas fa-tasks"></i> Order Type Analysis</h3>
                    <div class="table-container">
                        <table id="ordertype-table">
                            <thead>
                                <tr>
                                    <th>Order Type</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table13-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table13-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="ordertype-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-14">
                    <h3><span class="system-number">14</span><i class="fas fa-calendar-day"></i> Performance By Day</h3>
                    <div class="table-container">
                        <table id="byday-table">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table14-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table14-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="byday-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-15">
                    <h3><span class="system-number">15</span><i class="fas fa-sliders-h"></i> SL Management Analysis</h3>
                    <div class="table-container">
                        <table id="slmanagement-table">
                            <thead>
                                <tr>
                                    <th>SL Management</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table15-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table15-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="slmanagement-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-16">
                    <h3><span class="system-number">16</span><i class="fas fa-bullseye"></i> TP Management Analysis</h3>
                    <div class="table-container">
                        <table id="tpmanagement-table">
                            <thead>
                                <tr>
                                    <th>TP Management</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table16-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table16-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="tpmanagement-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-17">
                    <h3><span class="system-number">17</span><i class="fas fa-times-circle"></i> Mistakes Analysis</h3>
                    <div class="table-container">
                        <table id="mistakes-table">
                            <thead>
                                <tr>
                                    <th>Mistake</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table17-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table17-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="mistakes-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="system-card" id="table-18">
                    <h3><span class="system-number">18</span><i class="fas fa-brain"></i> Psychology Analysis</h3>
                    <div class="table-container">
                        <table id="psychology-table">
                            <thead>
                                <tr>
                                    <th>Psychology</th>
                                    <th>
                                        Model
                                        <div class="column-filter">
                                            <select id="table18-model-filter">
                                                <option value="">All Models</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>
                                        Symbol
                                        <div class="column-filter">
                                            <select id="table18-symbol-filter">
                                                <option value="">All Symbols</option>
                                            </select>
                                        </div>
                                    </th>
                                    <th>No. of Trades</th>
                                    <th>Outcomes</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody id="psychology-table-body">
                                <!-- Table rows will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Trading Journal v2.0 | System Analytics | 18 Performance Tables | Win Rate = Total Profit Trades / Total Trades</p>
        </footer>
    </div>

    <script>
        // Load trades from localStorage
        let trades = JSON.parse(localStorage.getItem('tradingJournalTrades')) || [];
        
        // Store current filters
        let currentFilters = {
            model: '',
            symbol: ''
        };
        
        // Store column filters for each table (8-18)
        let columnFilters = {};
        
        // Initialize the application when the DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Set up table selection
            const tableSelect = document.getElementById('table-select');
            tableSelect.addEventListener('change', function() {
                showTable(this.value);
            });
            
            // Set up refresh button
            document.getElementById('refresh-analytics').addEventListener('click', function() {
                trades = JSON.parse(localStorage.getItem('tradingJournalTrades')) || [];
                updateAllTables();
                updateOverallStats();
                populateFilterOptions();
                alert('Analytics refreshed with latest data!');
            });
            
            // Set up global filter buttons
            document.getElementById('apply-global-filters').addEventListener('click', applyGlobalFilters);
            document.getElementById('clear-global-filters').addEventListener('click', clearGlobalFilters);
            
            // Set up column filter change events for tables 8-18
            for (let i = 8; i <= 18; i++) {
                const modelFilter = document.getElementById(`table${i}-model-filter`);
                const symbolFilter = document.getElementById(`table${i}-symbol-filter`);
                
                if (modelFilter) {
                    modelFilter.addEventListener('change', function() {
                        updateTableWithColumnFilters(i);
                    });
                }
                
                if (symbolFilter) {
                    symbolFilter.addEventListener('change', function() {
                        updateTableWithColumnFilters(i);
                    });
                }
            }
            
            // Initialize on page load
            updateAllTables();
            updateOverallStats();
            populateFilterOptions();
            
            // Show first table by default
            showTable('1');
        });
        
        // Function to show selected table
        function showTable(tableNumber) {
            // Hide all tables
            for (let i = 1; i <= 18; i++) {
                const tableElement = document.getElementById(`table-${i}`);
                if (tableElement) {
                    tableElement.classList.remove('active');
                }
            }
            
            // Show selected table
            const selectedTable = document.getElementById(`table-${tableNumber}`);
            if (selectedTable) {
                selectedTable.classList.add('active');
                
                // Scroll to the table
                selectedTable.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // Show/hide global filters for tables 8-18
            const globalFilters = document.getElementById('global-filters');
            if (parseInt(tableNumber) >= 8 && parseInt(tableNumber) <= 18) {
                globalFilters.style.display = 'flex';
            } else {
                globalFilters.style.display = 'none';
            }
        }
        
        // Function to update overall statistics
        function updateOverallStats() {
            const totalTrades = trades.length;
            const profitTrades = trades.filter(t => t.netPnl > 0).length;
            const overallWinRate = totalTrades > 0 ? Math.round((profitTrades / totalTrades) * 100) : 0;
            
            // Find best performing model
            const models = {};
            trades.forEach(trade => {
                if (!models[trade.model]) {
                    models[trade.model] = { wins: 0, total: 0 };
                }
                models[trade.model].total++;
                if (trade.netPnl > 0) {
                    models[trade.model].wins++;
                }
            });
            
            let bestModel = '-';
            let bestModelRate = 0;
            
            Object.keys(models).forEach(model => {
                const winRate = Math.round((models[model].wins / models[model].total) * 100);
                if (winRate > bestModelRate) {
                    bestModel = model;
                    bestModelRate = winRate;
                }
            });
            
            // Find most traded symbol
            const symbols = {};
            trades.forEach(trade => {
                symbols[trade.symbol] = (symbols[trade.symbol] || 0) + 1;
            });
            
            let topSymbol = '-';
            let topSymbolCount = 0;
            
            Object.keys(symbols).forEach(symbol => {
                if (symbols[symbol] > topSymbolCount) {
                    topSymbol = symbol;
                    topSymbolCount = symbols[symbol];
                }
            });
            
            // Update DOM
            document.getElementById('total-trades').textContent = totalTrades;
            document.getElementById('overall-win-rate').textContent = `${overallWinRate}%`;
            document.getElementById('best-model').textContent = bestModel;
            document.getElementById('best-model-rate').textContent = `${bestModelRate}% Win Rate`;
            document.getElementById('top-symbol').textContent = topSymbol;
            document.getElementById('top-symbol-count').textContent = `${topSymbolCount} trades`;
        }
        
        // Function to populate filter options
        function populateFilterOptions() {
            // Get unique models and symbols
            const models = [...new Set(trades.map(trade => trade.model))].filter(Boolean);
            const symbols = [...new Set(trades.map(trade => trade.symbol))].filter(Boolean);
            
            // Populate global filters
            const globalModelFilter = document.getElementById('global-model-filter');
            const globalSymbolFilter = document.getElementById('global-symbol-filter');
            
            populateSelectOptions(globalModelFilter, models);
            populateSelectOptions(globalSymbolFilter, symbols);
            
            // Populate column filters for tables 8-18
            for (let i = 8; i <= 18; i++) {
                const modelFilter = document.getElementById(`table${i}-model-filter`);
                const symbolFilter = document.getElementById(`table${i}-symbol-filter`);
                
                if (modelFilter) {
                    populateSelectOptions(modelFilter, models);
                }
                
                if (symbolFilter) {
                    populateSelectOptions(symbolFilter, symbols);
                }
            }
        }
        
        // Helper function to populate select options
        function populateSelectOptions(selectElement, options) {
            // Clear existing options except the first one
            while (selectElement.options.length > 1) {
                selectElement.remove(1);
            }
            
            // Add new options
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                selectElement.appendChild(optionElement);
            });
        }
        
        // Function to apply global filters
        function applyGlobalFilters() {
            const modelFilter = document.getElementById('global-model-filter').value;
            const symbolFilter = document.getElementById('global-symbol-filter').value;
            
            currentFilters.model = modelFilter;
            currentFilters.symbol = symbolFilter;
            
            // Update all tables with filters
            updateAllTables();
        }
        
        // Function to clear global filters
        function clearGlobalFilters() {
            document.getElementById('global-model-filter').value = '';
            document.getElementById('global-symbol-filter').value = '';
            
            currentFilters.model = '';
            currentFilters.symbol = '';
            
            // Clear column filters for tables 8-18
            for (let i = 8; i <= 18; i++) {
                const modelFilter = document.getElementById(`table${i}-model-filter`);
                const symbolFilter = document.getElementById(`table${i}-symbol-filter`);
                
                if (modelFilter) modelFilter.value = '';
                if (symbolFilter) symbolFilter.value = '';
            }
            
            // Reset column filters
            columnFilters = {};
            
            // Update all tables without filters
            updateAllTables();
        }
        
        // Function to update all tables
        function updateAllTables() {
            updateTable1(); // Accounts
            updateTable2(); // Symbols
            updateTable3(); // Models
            updateTable4(); // News Impact
            updateTable5(); // Narrative
            updateTable6(); // Bias
            updateTable7(); // Market Conditions
            updateTable8(); // Type of Trade
            updateTable9(); // Session
            updateTable10(); // Entry Time Frame
            updateTable11(); // Confluences
            updateTable12(); // Entry Signals
            updateTable13(); // Order Type
            updateTable14(); // By Day
            updateTable15(); // SL Management
            updateTable16(); // TP Management
            updateTable17(); // Mistakes
            updateTable18(); // Psychology
        }
        
        // Function to get filtered trades based on current filters
        function getFilteredTrades(additionalFilters = {}) {
            let filteredTrades = trades;
            
            // Apply global filters
            if (currentFilters.model) {
                filteredTrades = filteredTrades.filter(trade => trade.model === currentFilters.model);
            }
            
            if (currentFilters.symbol) {
                filteredTrades = filteredTrades.filter(trade => trade.symbol === currentFilters.symbol);
            }
            
            // Apply additional filters
            if (additionalFilters.model) {
                filteredTrades = filteredTrades.filter(trade => trade.model === additionalFilters.model);
            }
            
            if (additionalFilters.symbol) {
                filteredTrades = filteredTrades.filter(trade => trade.symbol === additionalFilters.symbol);
            }
            
            return filteredTrades;
        }
        
        // Function to update table with column filters
        function updateTableWithColumnFilters(tableNumber) {
            const modelFilter = document.getElementById(`table${tableNumber}-model-filter`).value;
            const symbolFilter = document.getElementById(`table${tableNumber}-symbol-filter`).value;
            
            // Store column filters
            columnFilters[tableNumber] = {
                model: modelFilter,
                symbol: symbolFilter
            };
            
            // Update the specific table
            switch(tableNumber) {
                case 8: updateTable8(); break;
                case 9: updateTable9(); break;
                case 10: updateTable10(); break;
                case 11: updateTable11(); break;
                case 12: updateTable12(); break;
                case 13: updateTable13(); break;
                case 14: updateTable14(); break;
                case 15: updateTable15(); break;
                case 16: updateTable16(); break;
                case 17: updateTable17(); break;
                case 18: updateTable18(); break;
            }
        }
        
        // Table 1: Accounts Performance
        function updateTable1() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('accounts-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="3" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const accounts = calculateAnalytics('account', filteredTrades);
            
            tableBody.innerHTML = accounts.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td class="win-rate">${item.winRate}%</td>
                    <td>${item.count}</td>
                </tr>
            `).join('');
        }
        
        // Table 2: Symbols Performance
        function updateTable2() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('symbols-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const symbols = calculateAnalytics('symbol', filteredTrades);
            
            tableBody.innerHTML = symbols.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 3: Trading Models
        function updateTable3() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('models-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const models = calculateAnalytics('model', filteredTrades);
            
            tableBody.innerHTML = models.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 4: News Impact Analysis
        function updateTable4() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('news-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="3" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const newsImpact = calculateAnalytics('newsImpact', filteredTrades);
                                    
					tableBody.innerHTML = newsImpact.flatMap(item =>
					  item.name.map(value => `
					    <tr>
					      <td>${value}</td>
					      <td>${item.count}</td>
					      <td>
					        <div class="outcomes-cell">
					          <span class="outcome-badge outcome-profit">${item.wins}W</span>
					          <span class="outcome-badge outcome-loss">${item.losses}L</span>
					          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
					        </div>
					      </td>
					      <td class="win-rate">${item.winRate}%</td>
					    </tr>
					  `)
					).join('');
        }
        
        // Table 5: Narrative Analysis
        function updateTable5() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('narrative-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const narrative = calculateAnalytics('narrative', filteredTrades);
            
            tableBody.innerHTML = narrative.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 6: Bias Analysis
        function updateTable6() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('bias-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const bias = calculateAnalytics('bias', filteredTrades);
            
            tableBody.innerHTML = bias.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 7: Market Conditions
        function updateTable7() {
            const filteredTrades = getFilteredTrades();
            const tableBody = document.getElementById('market-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const marketConditions = calculateAnalytics('marketConditions', filteredTrades);
            
            tableBody.innerHTML = marketConditions.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 8: Type of Trade Analysis
        function updateTable8() {
            const filteredTrades = getFilteredTrades(columnFilters[8]);
            const tableBody = document.getElementById('tradetype-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const tradeTypeData = calculateCombinedAnalytics('tradeType', filteredTrades);
            
            tableBody.innerHTML = tradeTypeData.map(item => `
                <tr>
                    <td>${item.category}</td>
                    <td>${item.model}</td>
                    <td>${item.symbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 9: Session Analysis
        function updateTable9() {
            const filteredTrades = getFilteredTrades(columnFilters[9]);
            const tableBody = document.getElementById('session-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const sessionData = calculateCombinedAnalytics('session', filteredTrades);
            
            tableBody.innerHTML = sessionData.map(item => `
                <tr>
                    <td>${item.category}</td>
                    <td>${item.model}</td>
                    <td>${item.symbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 10: Entry Time Frame Analysis
        function updateTable10() {
            const filteredTrades = getFilteredTrades(columnFilters[10]);
            const tableBody = document.getElementById('timeframe-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const timeframeData = calculateCombinedAnalytics('entryTimeframe', filteredTrades);
            
            tableBody.innerHTML = timeframeData.map(item => `
                <tr>
                    <td>${item.category}</td>
                    <td>${item.model}</td>
                    <td>${item.symbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 11: Confluences Analysis
        function updateTable11() {
            const filteredTrades = getFilteredTrades(columnFilters[11]);
            const tableBody = document.getElementById('confluences-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const confluencesData = calculateCombinedAnalytics('confluences', filteredTrades);
            console.log(JSON.stringify(confluencesData));
            tableBody.innerHTML = confluencesData.flatMap(Bb =>
            Bb.category.map(item => `
                <tr>
                    <td>${item}</td>
                    <td>${item.model}</td>
                    <td>${item.symbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
 						  `)
            ).join('');            
        }
        
        // Table 12: Entry Signals Analysis
        function updateTable12() {
            const filteredTrades = getFilteredTrades(columnFilters[12]);
            const tableBody = document.getElementById('entrysignals-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const entrySignalsData = calculateCombinedAnalytics('entrySignals', filteredTrades);
           
        		tableBody.innerHTML = entrySignalsData.flatMap(item =>
						  item.category.map(cat => `
						    <tr>
						      <td>${cat.trim()}</td>
						      <td>${item.model}</td>
						      <td>${item.symbol}</td>
						      <td>${item.count}</td>
						      <td>
						        <div class="outcomes-cell">
						          <span class="outcome-badge outcome-profit">${item.wins}W</span>
						          <span class="outcome-badge outcome-loss">${item.losses}L</span>
						          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
						        </div>
						      </td>
						      <td class="win-rate">${item.winRate}%</td>
						    </tr>
						  `)
						).join('');
        }
        
        // Table 13: Order Type Analysis
        function updateTable13() {
            const filteredTrades = getFilteredTrades(columnFilters[13]);
            const tableBody = document.getElementById('ordertype-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const orderTypeData = calculateCombinedAnalytics('orderType', filteredTrades);
            
            tableBody.innerHTML = orderTypeData.map(item => `
                <tr>
                    <td>${item.category}</td>
                    <td>${item.model}</td>
                    <td>${item.symbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 14: Performance By Day
        function updateTable14() {
            const filteredTrades = getFilteredTrades(columnFilters[14]);
            const tableBody = document.getElementById('byday-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const byDayData = calculateByDay(filteredTrades);
            
            tableBody.innerHTML = byDayData.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.topModel}</td>
                    <td>${item.topSymbol}</td>
                    <td>${item.count}</td>
                    <td>
                        <div class="outcomes-cell">
                            <span class="outcome-badge outcome-profit">${item.wins}W</span>
                            <span class="outcome-badge outcome-loss">${item.losses}L</span>
                            <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
                        </div>
                    </td>
                    <td class="win-rate">${item.winRate}%</td>
                </tr>
            `).join('');
        }
        
        // Table 15: SL Management Analysis
        function updateTable15() {
            const filteredTrades = getFilteredTrades(columnFilters[15]);
            const tableBody = document.getElementById('slmanagement-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const slManagementData = calculateCombinedAnalytics('slManagement', filteredTrades);
            
					tableBody.innerHTML = slManagementData.flatMap(item =>
					  item.category.map(cat => `
					    <tr>
					      <td>${cat.trim()}</td>
					      <td>${item.model}</td>
					      <td>${item.symbol}</td>
					      <td>${item.count}</td>
					      <td>
					        <div class="outcomes-cell">
					          <span class="outcome-badge outcome-profit">${item.wins}W</span>
					          <span class="outcome-badge outcome-loss">${item.losses}L</span>
					          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
					        </div>
					      </td>
					      <td class="win-rate">${item.winRate}%</td>
					    </tr>
					  `)
					).join('');
        }
        
        // Table 16: TP Management Analysis
        function updateTable16() {
            const filteredTrades = getFilteredTrades(columnFilters[16]);
            const tableBody = document.getElementById('tpmanagement-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const tpManagementData = calculateCombinedAnalytics('tpManagement', filteredTrades);
            
					tableBody.innerHTML = tpManagementData.flatMap(item =>
					  item.category.map(cat => `
					    <tr>
					      <td>${cat.trim()}</td>
					      <td>${item.model}</td>
					      <td>${item.symbol}</td>
					      <td>${item.count}</td>
					      <td>
					        <div class="outcomes-cell">
					          <span class="outcome-badge outcome-profit">${item.wins}W</span>
					          <span class="outcome-badge outcome-loss">${item.losses}L</span>
					          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
					        </div>
					      </td>
					      <td class="win-rate">${item.winRate}%</td>
					    </tr>
					  `)
					).join('');
        }
        
        // Table 17: Mistakes Analysis
        function updateTable17() {
            const filteredTrades = getFilteredTrades(columnFilters[17]);
            const tableBody = document.getElementById('mistakes-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const mistakesData = calculateCombinedAnalytics('mistakes', filteredTrades);
            
						tableBody.innerHTML = mistakesData.flatMap(item =>
						  item.category.map(cat => `
						    <tr>
						      <td>${cat.trim()}</td>
						      <td>${item.model}</td>
						      <td>${item.symbol}</td>
						      <td>${item.count}</td>
						      <td>
						        <div class="outcomes-cell">
						          <span class="outcome-badge outcome-profit">${item.wins}W</span>
						          <span class="outcome-badge outcome-loss">${item.losses}L</span>
						          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
						        </div>
						      </td>
						      <td class="win-rate">${item.winRate}%</td>
						    </tr>
						  `)
						).join('');
        }
        
        // Table 18: Psychology Analysis
        function updateTable18() {
            const filteredTrades = getFilteredTrades(columnFilters[18]);
            const tableBody = document.getElementById('psychology-table-body');
            
            if (filteredTrades.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="no-data">
                            <i class="fas fa-inbox"></i>
                            <p>No trade data available for the selected filters</p>
                            <a href="journal-table.html" class="show-all-btn">
                                <i class="fas fa-plus"></i> Add Trades
                            </a>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const psychologyData = calculateCombinedAnalytics('psychology', filteredTrades);
            
					tableBody.innerHTML = psychologyData.flatMap(item =>
					  item.category.map(cat => `
					    <tr>
					      <td>${cat.trim()}</td>
					      <td>${item.model}</td>
					      <td>${item.symbol}</td>
					      <td>${item.count}</td>
					      <td>
					        <div class="outcomes-cell">
					          <span class="outcome-badge outcome-profit">${item.wins}W</span>
					          <span class="outcome-badge outcome-loss">${item.losses}L</span>
					          <span class="outcome-badge outcome-break-even">${item.breakEvens}BE</span>
					        </div>
					      </td>
					      <td class="win-rate">${item.winRate}%</td>
					    </tr>
					  `)
					).join('');
        }
        
        // Function to calculate analytics for a given category
        function calculateAnalytics(category, tradesToAnalyze) {
            const categoryMap = {};
            
            tradesToAnalyze.forEach(trade => {
                const value = trade[category];
                if (!categoryMap[value]) {
                    categoryMap[value] = {
                        name: value,
                        count: 0,
                        wins: 0,
                        losses: 0,
                        breakEvens: 0
                    };
                }
                
                categoryMap[value].count++;
                
                if (trade.netPnl > 0) {
                    categoryMap[value].wins++;
                } else if (trade.netPnl < 0) {
                    categoryMap[value].losses++;
                } else {
                    categoryMap[value].breakEvens++;
                }
            });
            
            // Convert to array and calculate win rates
            return Object.values(categoryMap).map(item => {
                item.winRate = item.count > 0 ? 
                    Math.round((item.wins / item.count) * 100) : 0;
                return item;
            }).sort((a, b) => b.count - a.count);
        }
        
        // Function to calculate combined analytics (for tables 8-18)
        function calculateCombinedAnalytics(category, tradesToAnalyze) {
            // Group trades by the category, model, and symbol
            const groupedData = {};
            
            tradesToAnalyze.forEach(trade => {
                const key = `${trade[category]}|${trade.model}|${trade.symbol}`;
                if (!groupedData[key]) {
                    groupedData[key] = {
                        category: trade[category],
                        model: trade.model,
                        symbol: trade.symbol,
                        count: 0,
                        wins: 0,
                        losses: 0,
                        breakEvens: 0
                    };
                }
                
                groupedData[key].count++;
                
                if (trade.netPnl > 0) {
                    groupedData[key].wins++;
                } else if (trade.netPnl < 0) {
                    groupedData[key].losses++;
                } else {
                    groupedData[key].breakEvens++;
                }
            });
            
            // Convert to array and calculate win rates
            const result = Object.values(groupedData).map(item => {
                item.winRate = item.count > 0 ? 
                    Math.round((item.wins / item.count) * 100) : 0;
                return item;
            }).sort((a, b) => b.count - a.count);
            
            return result;
        }
        
        // Function to calculate analytics by day
        function calculateByDay(tradesToAnalyze) {
            const dayMap = {};
            const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            
            tradesToAnalyze.forEach(trade => {
                const date = new Date(trade.date);
                const dayName = daysOfWeek[date.getDay()];
                
                if (!dayMap[dayName]) {
                    dayMap[dayName] = {
                        name: dayName,
                        count: 0,
                        wins: 0,
                        losses: 0,
                        breakEvens: 0,
                        models: {},
                        symbols: {}
                    };
                }
                
                const dayData = dayMap[dayName];
                dayData.count++;
                
                // Track wins/losses
                if (trade.netPnl > 0) {
                    dayData.wins++;
                } else if (trade.netPnl < 0) {
                    dayData.losses++;
                } else {
                    dayData.breakEvens++;
                }
                
                // Track models
                if (!dayData.models[trade.model]) {
                    dayData.models[trade.model] = 0;
                }
                dayData.models[trade.model]++;
                
                // Track symbols
                if (!dayData.symbols[trade.symbol]) {
                    dayData.symbols[trade.symbol] = 0;
                }
                dayData.symbols[trade.symbol]++;
            });
            
            // Convert to array and calculate win rates
            return Object.values(dayMap).map(item => {
                item.winRate = item.count > 0 ? 
                    Math.round((item.wins / item.count) * 100) : 0;
                
                // Find top model for this day
                let topModel = 'None';
                let topModelCount = 0;
                for (const [model, count] of Object.entries(item.models)) {
                    if (count > topModelCount) {
                        topModelCount = count;
                        topModel = model;
                    }
                }
                item.topModel = topModel;
                
                // Find top symbol for this day
                let topSymbol = 'None';
                let topSymbolCount = 0;
                for (const [symbol, count] of Object.entries(item.symbols)) {
                    if (count > topSymbolCount) {
                        topSymbolCount = count;
                        topSymbol = symbol;
                    }
                }
                item.topSymbol = topSymbol;
                
                return item;
            }).sort((a, b) => daysOfWeek.indexOf(a.name) - daysOfWeek.indexOf(b.name));
        }
    </script>
</body>
</html>
